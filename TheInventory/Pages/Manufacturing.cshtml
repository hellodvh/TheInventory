@page
@model TheInventory.Pages.ManufacturingModel
@{
    ViewData["Title"] = "Manufacturing";
}

@{
    if(Model.Message != "")
    {
        <div class="alert alert-success">@Model.Message</div>
    }
}

<!--Top Navbar-->
  <nav class="navbar navbar-expand-lg bg-light sticky-top rounded-3">
      <img class="rounded-lg-3" src="images/factory-machine.png" alt="Manufacturing" width="32" style="margin:10px">
    <h4>@ViewData["Title"]</h4>
  </nav>

<!--TODO: 
    1. Add Raw Materials list section here.
    2. Add Vehicle Parts (Build/Recipe) list section here.
-->

<!--Manufacturing Container-->
<div class="container-fluid">
    <!--Alert Functionality-->
    <div class="alert alert-success text-success text-center" role="alert">Vehicle part has been crafted!</div>
    <div class="row mt-1">
        <div class="col-xl col-md-12 pb-3">
            <div class="card rounded-3 shadow-lg">
                <div class="card-header text-center">
                    Materials
                </div>
                <div class="card-body">  

                    <div class="card mb-2 shadow-sm hover-effect">
                        <div class="row g-0">
                            <div class="col-md-2 align-self-center bg-light">
                                <img src="./images/raw-materials.png" class="img-fluid rounded-start" alt="..." width="50" style="margin:10px">
                            </div>
                            <div class="col-md-8">
                                <div class="card-body">
                                    <h5 class="card-title">Steel Bar</h5>
                                    <p class="card-text">Raw Materials</p>
                                </div>
                            </div>
                            <div class="col-md-2 align-self-center counter">
                                <div class="">
                                    <h3>200</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">    
        <div class="col-xl col-md-12 pb-3">
            <div class="card rounded-3 shadow-lg">
                <div class="card-header text-center">
                    Craftable Parts (Crafting)
                </div>
                <div class="card-body">
                    
                    @foreach(var recipe in Model.allRecipes)
                    {
                    <div class="col-6">
                        <div class="card @(recipe.IsCraftable() ? "boreder-success" : "bg-light")">
                            @*<img class="card-img-top" src="@block.ImageUrl" alt="Card image">*@
                            <div class="card-body">
                                <span>@recipe.Name</span>
                                <span style="float:right;">@recipe.Count</span>
                                @*<h5 class="card-title">@block.Name</h5>*@
                                <h6 class="card-title">@recipe.RecipeType</h6>

                                <p>Ingredients</p>
                                @foreach(var ingredient in recipe.Ingredients)
                                {
                                    if(ingredient != "")
                                    {
                                        <p style="padding:0px;margin:0px;margin-left:20px">@ingredient</p>
                                    }
                                }

                                @{
                                    if(recipe.IsCraftable())
                                    {
                                        <form method="post" 
                                        asp-page-handler="craft" 
                                        asp-route-name="@recipe.Name"
                                        asp-route-count="@recipe.Count"
                                        >
                                        <!--Add a input field for each ingredient-->
                                            @{
                                                foreach(var ingredient in recipe.Ingredients)
                                                {
                                                    <input type="hidden" name="ingredient[]" value="@ingredient"/>
                                                }
                                            }

                                            <input class="btn btn-dark" type="submit" value="Craft Recipe"/>
                                        </form>
                                    }
                                }
                            </div>
                        </div>
                    </div>
                    }
                </div>   
            </div>
        </div>
    </div>
</div>
